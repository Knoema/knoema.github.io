<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Tanzania Health Monitor</title>
	<link rel="stylesheet" type='text/css' href='https://fonts.googleapis.com/css?family=Roboto'>
	<link rel="stylesheet" type='text/css' href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,700'>
	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
	<!--TODO Duplicated styles-->
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.7.3/css/bootstrap-select.min.css"/>
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/css/bootstrap-select.min.css">

	<link rel="stylesheet" type="text/css" href="http://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
	<link rel="stylesheet" type="text/css" href="css/style.css"/>
</head>

<body class="loading">

	<div class="ajax-loader"></div>

	<nav class="navbar">
		<div class="container-fluid">
			<div class="navbar-header">
				<a class="logo" href="#" alt="Tanzania health monitor">
					<img src="img/logo.png" />
				</a>
			</div>
			<ul class="nav navbar-nav navbar-right">
				<li>
					<div class="navbar-form navbar-left">
						<div class="form-group form-group">
							<input id="filter-objects" placeholder="Search" class="form-control search-input" />
						</div>
						<div class="form-group form-group">
							<button type="submit" class="btn btn-default" id="pin-button">
								<span class="glyphicon glyphicon-pushpin" aria-hidden="true"></span>
							</button>
						</div>
						<div id="main-menu" class="btn-group btn-group">
							<div class="btn btn-default active" data-mode="map">Map</div>
							<div class="btn btn-default"        data-mode="table">Table</div>
						</div>
					</div>
				</li>
			</ul>
		</div><!-- /.container-fluid -->
	</nav>

	<div id="content">
		<div id="map-legend" class="map-component">
			<div class="legend-item">
				<img src="img/clinic_icons_dispensary.png" />
				<div>Dispensary</div>
			</div>
			<div class="legend-item">
				<img src="img/clinic_icons_health_center.png" />
				<div>Health center</div>
			</div>
			<div class="legend-item">
				<img src="img/clinic_icons_hospital.png" />
				<div>Hospital</div>
			</div>
		</div>
		<div id="map-canvas" class="map-component"></div>
		<div id="table" style="display:none;">
			<table class="table stripped">
				<thead>
					<tr class="header">
						<th>Facility Name</th>
						<th>Ward Name</th>
						<th>Clinic</th>
						<th>Hours of operations</th>
					</tr>
				</thead>
				<tbody>
				</tbody>
			</table>
		</div>
		<div id="profile" class="container-fluid" style="display:none;">
		</div>
	</div>

	<!--Modal-->
	<div class="modal fade" tabindex="-1" role="dialog" id="drug-search-dialog" style="width: 400px;margin: 0 auto;">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<h4 class="modal-title">
						Facilities geo search
					</h4>
				</div>
				<div class="modal-body">
					<div class="row">
						<div class="col-md-12">
							<p>
								<h5>Search for</h5>
								<select id="drug-select"></select>
							</p>
							<br />
							<p>
								<h5>Select distance, km</h5>
								<div class="input-group" style="width: 220px;">
									<span class="input-group-btn">
										<button class="btn" type="button" data-action="down">
											<span class="glyphicon glyphicon glyphicon-chevron-down" aria-hidden="true"></span>
										</button>
									</span>

									<input id="distance" type="text" class="form-control" />

									<span class="input-group-btn">
										<button class="btn" type="button" data-action="up">
											<span class="glyphicon glyphicon-chevron-up" aria-hidden="true"></span>
										</button>
									</span>
								</div>
							</p>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal" id="drug-search-subimit">Show facilities</button>
				</div>
			</div>
		</div>
	</div>
	<!--/Modal-->

	<!--Modal-->
	<div class="modal modal-wide fade" tabindex="-1" role="dialog" id="modal-dialog">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title"></h4>
			</div>
			<div class="modal-body">
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
			</div>
		</div>
	</div>	
	<!--/Modal-->

	<script id="profile-template-2" type="text/x-jQuery-tmpl">
		<h1>profile-template-two-columns</h1>
		<div>
			${JSON.stringify(profileData)}
		</div>
	</script>

	<!--TEMPLATES-->
	<script id="profile-template" type="text/x-jQuery-tmpl">

		<div id="back-button">
			<a href="#">
				<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
			</a>
		</div>
		<div class="row">
			<div class="col-sm-3">
				<div class="thumbnail">
					<img id="preview-image" src="img/hospitals.jpg" alt="img/hospitals.jpg" />
				</div>
			</div>
			<div class="col-sm-9">
				<ul class="nav nav-tabs profile-tabs" role="tablist">
					{{each(i, tab) profileData}}
						<li role="presentation" {{if (i==0)}}class="active"{{/if}}>
							<a href="#tab-${i}" aria-controls="home" role="tab" data-toggle="tab">${tab.tabName}</a>
						</li>
					{{/each}}
				</ul>
				<div class="tab-content">
					{{each(i, tab) profileData}}
						<div role="tabpanel" class="tab-pane {{if (i==0)}}active{{/if}}" id="tab-${i}">

							<div class="drug-list">

							{{if tab.tabName == 'Drugs list'}}

								{{if typeof tab.drugsList !== 'undefined'}}
									<table class="table table-striped table-condensed drug-list-table">
										<thead>
											<tr>
												<th>Tracer Commodity Checklist</th>
												<th>Bin card available with commodity</th>
												<th>Physical Count</th>
												<th>FEFO (Yes / No)</th>
												<th>Exp Date (soonest)</th>
												<th>Notes</th>
											</tr>
										</thead>
										<tbody>
											{{each(j, drug) tab.drugsList}}
													<tr>
														<td>${drug[5]}</td>
														<td style="{{if drug[6]=='N' || drug[6] == '' || drug[6] == 0}}color:red;{{/if}}">${drug[6]}</td>
														<td>${drug[7]}</td>
														<td>${drug[8]}</td>
														<td>${drug[9]}</td>
														<td>${drug[10]}</td>
													</tr>
											{{/each}}
										</tbody>
									</table>
								{{else}}
									<p>No data on drugs availability</p>
								{{/if}}

							{{else}}

								{{each(j, indicator) tab.indicators}}
									{{if (typeof indicator.children !== 'undefined')}}
										<h4 class="item-header">${indicator.name}</h4>
										<table class="table table-striped table-condensed" style="width: 300px;">
											<tbody>
												{{each(k, child) indicator.children}}
													<tr>
														<td>
															${child.name}
														</td>
														<td>
															${child.value}
														</td>
													</tr>
												{{/each}}
											</tbody>
										</table>
										<hr />
									{{else}}
										<div>
											<h4 class="item-header inline-header">${indicator.name}</h4>
											<div class="inline-value">
												${indicator.value}
											</div>
										</div>
									{{/if}}
								{{/each}}
							{{/if}}
							</div>
						</div>
					{{/each}}
				</div>
			</div>
		</div>
	</script>

	<script id="tmpl-table-row" type="text/x-jQuery-tmpl">
		<tr data-facility-name="${data['Facility Name']}" data-layer-id="${data.layerId}">
			<td>${data['Facility Name']}</td>
			<td>${data['Ward Name']}</td>
			<td>${data['Clinic']}</td>
			<td>${data['Hours of Operation (opening hours)']}</td>
		</tr>
	</script>
	<!--TEMPLATES-->

	<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=visualization,drawing"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.6.1/lodash.min.js"></script>

	<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.7.3/js/bootstrap-select.min.js"></script>
	<script src="http://code.jquery.com/ui/1.11.4/jquery-ui.min.js" type="text/javascript"></script>

	<script src="http://knoema.com/app-script?version=2.0"></script>

	<!-- dependencies of layer. I think we need to get rid of them -->
	<script src="http://knoema.com/js/googlemap/bubbleslayer.js"></script>
	<script src="http://knoema.com/js/googlemap/canvaslayer.js"></script>

	<!-- basic script for rendering map layers, markerclusterer required by layer -->
	<script src="http://knoema.com/Js/GoogleMap/markerclusterer.js?v=1"></script>
	<script src="http://knoema.com/js/geoplayground/geo-playground-layer.js?v=1"></script>

	<!-- Latest compiled and minified JavaScript -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/js/bootstrap-select.min.js"></script>

	<script>
		Knoema.Helpers.clientId = 'EZj54KGFo3rzIvnLczrElvAitEyU28DGw9R73tif';
	</script>

	<script src="js/jquery.tmpl.js"></script>
	<script src="js/jquery.stickytableheaders.min.js"></script>

	<script src="js/dataDescriptor.js"></script>

	<script src="js/app.js"></script>

</body>
</html>